var resBaldrickTriggers;jQuery(function(a){var r=[],e=function(e,t,s){var l=a("#progress-file-"+t),i=a("."+t+" .file-size");cf_uploader_filelist[t].state=2,a.ajax({xhr:function(){var a=new window.XMLHttpRequest;return a.upload.addEventListener("progress",function(a){if(a.lengthComputable){var r=a.loaded/a.total*100;l.width(r+"%"),i.html(size_format(a.loaded)+" / "+size_format(a.total))}},!1),a.addEventListener("progress",function(a){a.lengthComputable&&a.loaded/a.total},!1),a},url:e.data("request")+"/upload/",type:"POST",data:s,processData:!1,contentType:!1,success:function(s,l,i){if(s.success&&s.success===!0){r.pop(),a('[data-file="'+t+'"]').remove(),a("."+t).slideUp(),cf_uploader_filelist[t].state=3;var d=!0;for(var o in cf_uploader_filelist){d=!1;break}r.length?console.log(r):e.submit()}else if(s.data&&!s.success)return a("."+t).addClass("has-error"),e.find(":submit").prop("disabled",!1),e.find(".cf-uploader-trigger").slideDown(),a("."+t+" .file-error").html(s.data),console.log(s.success),void console.log(s.data)},error:function(a,r,t){e.data("postDisable")||buttons.prop("disabled",!1)}})};(resBaldrickTriggers=function(){a(".cfajax-trigger").baldrick({request:"./",method:"POST",before:function(t,s){s.preventDefault();var l=a(t),i=l.find(":submit");if(l.data("_cf_manual"))return l.find('[name="cfajax"]').remove(),!1;var d=l.parsley({errorsWrapper:'<span class="help-block caldera_ajax_error_block"></span>',errorTemplate:"<span></span>"});if(!d.isValid())return d.destroy(),!1;if(d.destroy(),l.data("postDisable")||i.prop("disabled",!0),"object"==typeof cf_uploader_filelist){console.log(l.find(".cf-multi-uploader[data-required]")),l.find(".cf-uploader-trigger").slideUp();var o=!1,n=0;for(var c in cf_uploader_filelist)if(!(cf_uploader_filelist[c].state>1)){o=!0;var p=new FormData,f=c,u=a("#"+f.split("_file_")[0]);if(p.append(u.data("field"),cf_uploader_filelist[c]),p.append("field",u.data("field")),p.append("control",u.data("controlid")),e(l,f,p),n++,3===n)break}if(!0===o||r.length)return!1}},error:function(a){404===a.jqxhr.status&&this.trigger.data("_cf_manual",!0).trigger("submit")},callback:function(r){if(r.params.trigger.find(":submit").prop("disabled",!1),r.params.trigger.data("instance"),r.params.trigger.data("customCallback")&&"function"==typeof window[r.params.trigger.data("customCallback")]&&window[r.params.trigger.data("customCallback")](r.data),r.params.trigger.data("inhibitnotice")||(a(".caldera_ajax_error_wrap").removeClass("caldera_ajax_error_wrap").removeClass("has-error"),a(".caldera_ajax_error_block").remove(),"complete"===r.data.status||"success"===r.data.type?(r.data.html&&r.params.target.html(r.data.html),r.params.trigger.data("hiderows")&&r.params.trigger.find("div.row").remove()):"preprocess"===r.data.status?r.params.target.html(r.data.html):"error"===r.data.status&&r.params.target.html(r.data.html)),"complete"!==r.data.status&&"success"!==r.data.type||r.data.entry||r.params.trigger[0].reset(),r.data.url&&(r.params.trigger.hide(),window.location=r.data.url),r.params.trigger.find(".cf-uploader-trigger").slideDown(),r.data.fields)for(var e in r.data.fields){var t=r.params.trigger.find('[data-field="'+e+'"]'),s=t.parent();s.is("label")&&(s=s.parent(),(s.hasClass("checkbox")||s.hasClass("radio"))&&(s=s.parent()));var l=s.find(".help-block").not(".caldera_ajax_error_block");s.addClass("has-error").addClass("caldera_ajax_error_wrap"),l.length&&l.hide(),s.append('<span class="help-block caldera_ajax_error_block">'+r.data.fields[e]+"</span>")}a(document).trigger("cf.submission"),a(document).trigger("cf."+r.data.type)}})})()});